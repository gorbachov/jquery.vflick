/*! 
 * [jquery.vflick]
 * jquery library for SP flick
 * 
 * @version 0.1.0
 * @url 
 * 
 * Copyright d.m.connectings
 * Licensed under the MIT License
*/
!function(a){var b={};b.touch="ontouchstart"in window;var c=b.touch?"touchstart":"mousedown",d=b.touch?"touchmove":"mousemove",e=b.touch?"touchend":"mouseup",f=b.touch?"resize":"resize",g=b.touch?"scroll":"scroll";b.venders={},b.venders.prefix={webkit:"-webkit-",moz:"",o:"-o-",none:""},b.venders.transitionEnd={webkit:"webkitTransitionEnd",moz:"transitionend",o:"otransitionEnd",none:"transitionend"},b.vendor=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"moz":"opera"in window?"o":"none",a.fn.vflick=function(h){h=a.extend({verticalFlick:!1,flickClass:".flick",transitionSpeed:350,transitionTiming:"cubic-bezier(0, 0, 0.25, 1)",threshold:.3,fsEndAnim:function(){}},h);var i=this,j={};j.dist=0,j.direction=0,j.endpoint=0,j.num=0,j.length=0,j.offset={x:0,y:0},j.client={x:0,y:0},j.leave={x:0,y:0},j.scroll={x:0,y:0};var k={};k.size={w:a(i).parent().width(),h:a(i).parent().height()},k.pos={x:a(i).parent().offset().left,y:a(i).parent().offset().top},k.direction={loc:h.verticalFlick?"y":"x",vol:h.verticalFlick?"h":"w"};var l={flick:{},win:{}},m={},n={},o=!1;return m.loopChange=function(){1==j.direction?(a(i).find(h.flickClass).first().insertAfter(a(i).find(h.flickClass).last()),j.num=j.num>=j.length-1?0:j.num+1):2==j.direction&&(a(i).find(h.flickClass).last().insertBefore(a(i).find(h.flickClass).first()),j.num=j.num<=0?j.length-1:j.num-1)},m.endAnimV=function(){m.loopChange(),a(i).attr({style:b.venders.prefix[b.vendor]+"transform: translate3d(0, -"+k.size[k.direction.vol]+"px, 0);"}),h.fsEndAnim(j.num)},m.endAnimH=function(){m.loopChange(),a(i).attr({style:b.venders.prefix[b.vendor]+"transform: translate3d(-"+k.size[k.direction.vol]+"px, 0, 0);"}),h.fsEndAnim(j.num)},m.slide=function(){h.verticalFlick?a(i).attr({style:b.venders.prefix[b.vendor]+"transform: translate3d(0, "+j.endpoint+"px, 0);"+b.venders.prefix[b.vendor]+"transition: "+b.venders.prefix[b.vendor]+"transform "+h.transitionSpeed+"ms "+h.transitionTiming+";"}).unbind(b.venders.transitionEnd[b.vendor]).on(b.venders.transitionEnd[b.vendor],m.endAnimV):a(i).attr({style:b.venders.prefix[b.vendor]+"transform: translate3d("+j.endpoint+"px, 0, 0);"+b.venders.prefix[b.vendor]+"transition: "+b.venders.prefix[b.vendor]+"transform "+h.transitionSpeed+"ms "+h.transitionTiming+";"}).unbind(b.venders.transitionEnd[b.vendor]).on(b.venders.transitionEnd[b.vendor],m.endAnimH)},l.flick[c]=function(c){j.offset.x=b.touch?c.originalEvent.changedTouches[0].pageX-k.pos.x:c.pageX-a(this).offset().left-j.scroll.x,j.offset.y=b.touch?c.originalEvent.changedTouches[0].pageY-k.pos.y:c.pageY-a(this).offset().top-j.scroll.y,a(i).find("input,textarea").blur(),o=!0},l.flick[d]=function(c){o&&(c.preventDefault(),j.client.x=b.touch?c.originalEvent.changedTouches[0].pageX:c.clientX,j.client.y=b.touch?c.originalEvent.changedTouches[0].pageY:c.clientY-k.size[k.direction.vol],j.dist=-1*(k.pos[k.direction.loc]+k.size[k.direction.vol]-j.client[k.direction.loc])-j.offset[k.direction.loc],a(i).attr(h.verticalFlick?{style:b.venders.prefix[b.vendor]+"transform: translate3d(0, "+j.dist+"px, 0);"}:{style:b.venders.prefix[b.vendor]+"transform: translate3d("+j.dist+"px, 0, 0);"}))},l.win[e]=function(a){o&&(j.leave.x=b.touch?a.originalEvent.changedTouches[0].pageX:a.clientX,j.leave.y=b.touch?a.originalEvent.changedTouches[0].pageY:a.clientY,Math.abs(j.offset[k.direction.loc]-(j.leave[k.direction.loc]-k.pos[k.direction.loc]))>h.threshold*k.size[k.direction.vol]?j.offset[k.direction.loc]>j.client[k.direction.loc]-k.pos[k.direction.loc]?(j.endpoint=2*k.size[k.direction.vol]*-1,j.direction=1):(j.endpoint=0,j.direction=2):(j.endpoint=-1*k.size[k.direction.vol],j.direction=0),m.slide(),o=!1)},l.win[f]=function(){k.size={w:a(i).parent().width(),h:a(i).parent().height()},k.pos={x:a(i).parent().offset().left,y:a(i).parent().offset().top},j.scroll.x=a(window).scrollLeft(),j.scroll.y=a(window).scrollTop()},l.win[g]=function(){j.scroll.x=a(window).scrollLeft(),j.scroll.y=a(window).scrollTop()},n.goNext=function(a){a.preventDefault(),j.endpoint=2*k.size[k.direction.vol]*-1,j.direction=1,m.slide()},n.goPrev=function(a){a.preventDefault(),j.endpoint=0,j.direction=2,m.slide()},j.length=a(i).find(h.flickClass).size(),j.length<2?void 0:(j.length<3&&(a(i).find(h.flickClass).eq(0).clone(!0).insertAfter(a(i).find(h.flickClass).last()),a(i).find(h.flickClass).eq(1).clone(!0).insertAfter(a(i).find(h.flickClass).last())),a(i).find(h.flickClass).last().insertBefore(a(i).find(h.flickClass).first()),a(i).attr(h.verticalFlick?{style:b.venders.prefix[b.vendor]+"transform: translate3d(0, -"+k.size[k.direction.vol]+"px, 0);"}:{style:b.venders.prefix[b.vendor]+"transform: translate3d(-"+k.size[k.direction.vol]+"px, 0, 0);"}),a(i).find(h.flickClass).bind(l.flick),a(window).bind(l.win),n.jq=a(i),n)}}(jQuery);