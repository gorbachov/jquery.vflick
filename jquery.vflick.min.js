/*! 
 * [jquery.vflick]
 * jquery library for SP flick
 * 
 * @version 0.1.0
 * @url 
 * 
 * Copyright d.m.connectings
 * Licensed under the MIT License
*/
!function($){var support={};support.touch="ontouchstart"in window;var touchStartEvent=support.touch?"touchstart":"mousedown",touchMoveEvent=support.touch?"touchmove":"mousemove",touchEndEvent=support.touch?"touchend":"mouseup",resizeEvent=support.touch?"resize":"resize",scrollEvent=support.touch?"scroll":"scroll";support.venders={},support.venders.prefix={webkit:"-webkit-",moz:"",o:"-o-",none:""},support.venders.transitionEnd={webkit:"webkitTransitionEnd",moz:"transitionend",o:"otransitionEnd",none:"transitionend"},support.vendor=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"moz":"opera"in window?"o":"none",$.fn.vflick=function(opt){opt=$.extend({verticalFlick:!1,flickClass:".flick",transitionSpeed:350,transitionTiming:"cubic-bezier(0, 0, 0.25, 1)",threshold:.3,fsEndAnim:function(){}},opt);var elm=this,pos={};pos.dist=0,pos.direction=0,pos.endpoint=0,pos.num=0,pos.length=0,pos.offset={x:0,y:0},pos.client={x:0,y:0},pos.leave={x:0,y:0},pos.scroll={x:0,y:0};var flick={};flick.size={w:$(elm).parent().width(),h:$(elm).parent().height()},flick.pos={x:$(elm).parent().offset().left,y:$(elm).parent().offset().top},flick.direction={loc:opt.verticalFlick?"y":"x",vol:opt.verticalFlick?"h":"w"};var events={flick:{},win:{}},methods={},returnObjects={},dg=!1;return methods.loopChange=function(){1==pos.direction?($(elm).find(opt.flickClass).first().insertAfter($(elm).find(opt.flickClass).last()),pos.num=pos.num>=pos.length-1?0:pos.num+1):2==pos.direction&&($(elm).find(opt.flickClass).last().insertBefore($(elm).find(opt.flickClass).first()),pos.num=pos.num<=0?pos.length-1:pos.num-1)},methods.endAnimV=function(){methods.loopChange(),$(elm).attr({style:support.venders.prefix[support.vendor]+"transform: translate3d(0, -"+flick.size[flick.direction.vol]+"px, 0);"}),opt.fsEndAnim(pos.num)},methods.endAnimH=function(){methods.loopChange(),$(elm).attr({style:support.venders.prefix[support.vendor]+"transform: translate3d(-"+flick.size[flick.direction.vol]+"px, 0, 0);"}),opt.fsEndAnim(pos.num)},methods.slide=function(){opt.verticalFlick?$(elm).attr({style:support.venders.prefix[support.vendor]+"transform: translate3d(0, "+pos.endpoint+"px, 0);"+support.venders.prefix[support.vendor]+"transition: "+support.venders.prefix[support.vendor]+"transform "+opt.transitionSpeed+"ms "+opt.transitionTiming+";"}).unbind(support.venders.transitionEnd[support.vendor]).on(support.venders.transitionEnd[support.vendor],methods.endAnimV):$(elm).attr({style:support.venders.prefix[support.vendor]+"transform: translate3d("+pos.endpoint+"px, 0, 0);"+support.venders.prefix[support.vendor]+"transition: "+support.venders.prefix[support.vendor]+"transform "+opt.transitionSpeed+"ms "+opt.transitionTiming+";"}).unbind(support.venders.transitionEnd[support.vendor]).on(support.venders.transitionEnd[support.vendor],methods.endAnimH)},events.flick[touchStartEvent]=function(e){pos.offset.x=support.touch?e.originalEvent.changedTouches[0].pageX-flick.pos.x:e.pageX-$(this).offset().left-pos.scroll.x,pos.offset.y=support.touch?e.originalEvent.changedTouches[0].pageY-flick.pos.y:e.pageY-$(this).offset().top-pos.scroll.y,$(elm).find("input,textarea").blur(),dg=!0},events.flick[touchMoveEvent]=function(e){dg&&(e.preventDefault(),pos.client.x=support.touch?e.originalEvent.changedTouches[0].pageX:e.clientX,pos.client.y=support.touch?e.originalEvent.changedTouches[0].pageY:e.clientY-flick.size[flick.direction.vol],pos.dist=-1*(flick.pos[flick.direction.loc]+flick.size[flick.direction.vol]-pos.client[flick.direction.loc])-pos.offset[flick.direction.loc],$(elm).attr(opt.verticalFlick?{style:support.venders.prefix[support.vendor]+"transform: translate3d(0, "+pos.dist+"px, 0);"}:{style:support.venders.prefix[support.vendor]+"transform: translate3d("+pos.dist+"px, 0, 0);"}))},events.win[touchEndEvent]=function(e){dg&&(pos.leave.x=support.touch?e.originalEvent.changedTouches[0].pageX:e.clientX,pos.leave.y=support.touch?e.originalEvent.changedTouches[0].pageY:e.clientY,Math.abs(pos.offset[flick.direction.loc]-(pos.leave[flick.direction.loc]-flick.pos[flick.direction.loc]))>opt.threshold*flick.size[flick.direction.vol]?pos.offset[flick.direction.loc]>pos.client[flick.direction.loc]-flick.pos[flick.direction.loc]?(pos.endpoint=2*flick.size[flick.direction.vol]*-1,pos.direction=1):(pos.endpoint=0,pos.direction=2):(pos.endpoint=-1*flick.size[flick.direction.vol],pos.direction=0),methods.slide(),dg=!1)},events.win[resizeEvent]=function(){flick.size={w:$(elm).parent().width(),h:$(elm).parent().height()},flick.pos={x:$(elm).parent().offset().left,y:$(elm).parent().offset().top},pos.scroll.x=$(window).scrollLeft(),pos.scroll.y=$(window).scrollTop()},events.win[scrollEvent]=function(){pos.scroll.x=$(window).scrollLeft(),pos.scroll.y=$(window).scrollTop()},returnObjects.goNext=function(e){e.preventDefault(),pos.endpoint=2*flick.size[flick.direction.vol]*-1,pos.direction=1,methods.slide()},returnObjects.goPrev=function(e){e.preventDefault(),pos.endpoint=0,pos.direction=2,methods.slide()},pos.length=$(elm).find(opt.flickClass).size(),pos.length<2?void 0:(pos.length<3&&($(elm).find(opt.flickClass).eq(0).clone(!0).insertAfter($(elm).find(opt.flickClass).last()),$(elm).find(opt.flickClass).eq(1).clone(!0).insertAfter($(elm).find(opt.flickClass).last())),$(elm).find(opt.flickClass).last().insertBefore($(elm).find(opt.flickClass).first()),$(elm).attr(opt.verticalFlick?{style:support.venders.prefix[support.vendor]+"transform: translate3d(0, -"+flick.size[flick.direction.vol]+"px, 0);"}:{style:support.venders.prefix[support.vendor]+"transform: translate3d(-"+flick.size[flick.direction.vol]+"px, 0, 0);"}),$(elm).find(opt.flickClass).bind(events.flick),$(window).bind(events.win),returnObjects.jq=$(elm),returnObjects)}}(jQuery);